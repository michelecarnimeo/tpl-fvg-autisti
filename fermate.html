<!DOCTYPE html>
<html lang="it">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>TPL FVG - Fermate</title>
  <!-- Font locali per PWA offline -->
  <!-- CSS personalizzati -->
  <link rel="stylesheet" href="style1.css">
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="src/tpl.jpg" type="image/jpeg">
  <style>
    body {
      font-family: 'Roboto', Arial, sans-serif;
    }

    /* Nascondi card su mobile e aggiungi padding */
    @media (max-width: 768px) {
      .main-card {
        background: transparent !important;
        border: none !important;
        box-shadow: none !important;
        backdrop-filter: none !important;
        -webkit-backdrop-filter: none !important;
        padding: 1rem !important;
        margin: 0 !important;
        border-radius: 0 !important;
      }
      
      /* Nascondi griglia fermate e barra di ricerca su mobile nella pagina Fermate */
      .fermate-page #fermate-grid-container.show-on-mobile {
        display: none !important;
      }
      
      .fermate-page #search-container-fermate.show-on-mobile {
        display: none !important;
      }
    }
    
    /* Stili per messaggio mobile */
    .mobile-only-message {
      display: none;
      width: 100%;
      padding: 1rem;
    }
    
    @media (max-width: 768px) {
      .mobile-only-message {
        display: block !important;
      }
    }
    
    @media (min-width: 769px) {
      .mobile-only-message {
        display: none !important;
      }
    }
    
    .message-card {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 16px;
      padding: 2rem;
      text-align: center;
      box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
      animation: fadeIn 0.5s ease-in;
    }
    
    .message-icon {
      font-size: 4rem;
      margin-bottom: 1rem;
      animation: bounce 2s infinite;
    }
    
    .message-title {
      color: white;
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: 1rem;
    }
    
    .message-text {
      color: rgba(255, 255, 255, 0.95);
      font-size: 1rem;
      line-height: 1.6;
      margin-bottom: 1.5rem;
    }
    
    .message-button {
      display: inline-block;
      background: white;
      color: #667eea;
      padding: 0.875rem 2rem;
      border-radius: 50px;
      font-weight: 600;
      text-decoration: none;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }
    
    .message-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
    }
    
    @keyframes bounce {
      0%, 100% {
        transform: translateY(0);
      }
      50% {
        transform: translateY(-10px);
      }
    }
    
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  </style>
</head>

<body class="fermate-page">
  <!-- Navbar -->
  <header class="navbar">
    <div class="container">
      <div class="navbar-content">
        <a href="index.html" class="navbar-brand-link">
          <div class="navbar-brand">
            <div class="navbar-logo-wrapper">
              <img src="src/logo.png" alt="TPL" class="navbar-logo navbar-logo-default" />
              <img src="src/logo1.png" alt="TPL" class="navbar-logo navbar-logo-hover" />
            </div>
            <div class="navbar-title">
              <div class="logo-acronym">
                <div>tpl</div>
                <div>fvg</div>
              </div>
              <div class="logo-text">
                <div>trasporto</div>
                <div>pubblico</div>
                <div>locale</div>
              </div>
            </div>
          </div>
        </a>
        <!-- Hamburger button (mobile only) -->
        <button id="hamburger-toggle" class="hamburger-toggle" aria-label="Menu">
          <span class="hamburger-icon"></span>
        </button>
        
        <nav class="navbar-nav">
          <a href="index.html" class="nav-link">Home</a>
          <a href="fermate.html" class="nav-link active">Fermate</a>
          <a href="prezzi.html" class="nav-link">Prezzi</a>
          <button id="darkmode-toggle" class="dark-mode-toggle" title="Darkmode">
            <span>üåô</span>
          </button>
          <button class="animation-toggle" id="animationToggle" title="Toggle animazione sfondo">
            üé¨
          </button>
          <button id="cache-reset" class="cache-reset-btn" title="Verifica aggiornamenti e riavvia app">
            <span id="cache-icon">üîÑ</span>
          </button>
          <div class="font-size-group">
            <button id="font-size-small" class="font-size-btn" data-size="normal" title="Testo normale">
              <span>A</span>
            </button>
            <button id="font-size-medium" class="font-size-btn" data-size="large" title="Testo grande">
              <span>A</span>
            </button>
            <button id="font-size-large" class="font-size-btn" data-size="xlarge" title="Testo molto grande">
              <span>A</span>
            </button>
          </div>
        </nav>
      </div>
    </div>
    
    <!-- Mobile menu overlay -->
    <div id="mobile-menu-overlay" class="mobile-menu-overlay"></div>
    
    <!-- Mobile menu drawer -->
    <div id="mobile-menu" class="mobile-menu">
      <div class="mobile-menu-header">
        <span class="mobile-menu-title">Menu</span>
        <button id="mobile-menu-close" class="mobile-menu-close" aria-label="Chiudi menu">√ó</button>
      </div>
      <nav class="mobile-menu-nav">
        <a href="index.html" class="mobile-nav-link">
          <span class="mobile-nav-icon">üè†</span>
          <span>Home</span>
        </a>
        <a href="fermate.html" class="mobile-nav-link">
          <span class="mobile-nav-icon">üöå</span>
          <span>Fermate</span>
        </a>
        <a href="prezzi.html" class="mobile-nav-link">
          <span class="mobile-nav-icon">üí∞</span>
          <span>Prezzi</span>
        </a>
        <div class="mobile-menu-divider"></div>
        <button id="mobile-darkmode-toggle" class="mobile-nav-button">
          <span class="mobile-nav-icon">üåô</span>
          <span>Modalit√† scura</span>
        </button>
        <button id="mobile-animation-toggle" class="mobile-nav-button">
          <span class="mobile-nav-icon">üé¨</span>
          <span>Animazione sfondo</span>
        </button>
        <div class="mobile-menu-divider"></div>
        <div class="mobile-font-size-section">
          <span class="mobile-section-title">Dimensione testo</span>
          <div class="mobile-font-size-buttons">
            <button id="mobile-font-size-small" class="mobile-font-btn" data-size="normal" title="Testo normale">
              <span class="font-btn-letter">A</span>
              <span class="font-btn-label">Normale</span>
            </button>
            <button id="mobile-font-size-medium" class="mobile-font-btn" data-size="large" title="Testo grande">
              <span class="font-btn-letter">A</span>
              <span class="font-btn-label">Grande</span>
            </button>
            <button id="mobile-font-size-large" class="mobile-font-btn" data-size="xlarge" title="Testo molto grande">
              <span class="font-btn-letter">A</span>
              <span class="font-btn-label">Molto Grande</span>
            </button>
          </div>
        </div>
        
        <!-- Mini card versione -->
        <button class="mobile-version-card" id="mobile-version-card" title="Info o Riavvia">
          <div class="version-info">
            <div class="version-title">üîÑ Info o Riavvia</div>
            <div class="version-number" id="mobile-version-number">Versione 1.3.3</div>
            <div class="version-date" id="mobile-version-date">22 Ottobre 2025 21:30</div>
          </div>
        </button>
      </nav>
    </div>
  </header>

  <!-- Main Fermate -->
  <main class="main-content">
    <div class="container">
      <!-- Titolo -->
      <h1 class="page-title">Fermate per linea</h1>
      
      <!-- Pulsante selezione linea -->
      <div class="line-selector-container">
        <div class="form-group">
          <button id="linea-fermate-btn" class="route-button linea-select-btn">
            <span id="linea-fermate-text">Seleziona una linea</span>
            <span class="route-arrow">‚ñº</span>
          </button>
        </div>
        
        <!-- Barra di ricerca (nascosta inizialmente) -->
        <div id="search-container-fermate" class="search-container" style="display: none;">
          <div class="search-box">
            <span class="search-icon">üîç</span>
            <input type="text" id="search-input" class="search-input" placeholder="Cerca Fermata" />
            <button id="clear-search" class="clear-btn" style="display: none;">‚úï</button>
          </div>
        </div>
      </div>

      <!-- Messaggio mobile (visibile solo su mobile) -->
      <div id="mobile-fermate-message" class="mobile-only-message" style="display: none;">
        <div class="message-card">
          <div class="message-icon">üì±</div>
          <h3 class="message-title">Visualizzazione mobile</h3>
          <p class="message-text">
            L'elenco dettagliato delle fermate √® disponibile su desktop.<br>
            Su mobile puoi utilizzare la pagina <strong>Home</strong> per calcolare il prezzo del biglietto selezionando partenza e destinazione.
          </p>
          <a href="index.html" class="message-button">Vai alla Home</a>
        </div>
      </div>

      <!-- Griglia fermate (nascosta inizialmente) -->
      <div id="fermate-grid-container" class="fermate-grid" style="display: none;">
        <div class="fermate-card fade-in">
          <h3 id="andata-title">Andata</h3>
          <ul id="fermate-andata" class="fermate-list">
            <!-- Fermate generate da JS -->
          </ul>
        </div>
        <div class="fermate-card fade-in">
          <h3 id="ritorno-title">Ritorno</h3>
          <ul id="fermate-ritorno" class="fermate-list">
            <!-- Fermate generate da JS -->
          </ul>
        </div>
      </div>
      <!-- Banner installazione PWA -->
      <div id="pwa-install-banner" class="pwa-install-banner" style="display: none;">
        <div class="pwa-install-content">
          <div class="pwa-install-text">
            <span class="pwa-install-title">üì± Installa l'app</span>
            <span class="pwa-install-subtitle">Accedi pi√π velocemente e offline</span>
          </div>
          <div class="pwa-install-actions">
            <button id="pwa-install-later" class="pwa-btn pwa-btn-secondary" type="button">Pi√π tardi</button>
            <button id="pwa-install-button" class="pwa-btn pwa-btn-primary" type="button">Installa</button>
          </div>
        </div>
        <div id="pwa-ios-hint" class="pwa-ios-hint" style="display: none;">
          <div class="ios-hint-title">üì≤ Come installare su iPhone/iPad:</div>
          <ol class="ios-hint-steps">
            <li><span class="step-number">1.</span> Tocca il pulsante <strong>Condividi</strong> <span class="ios-share-icon">üì§</span> in basso (Safari)</li>
            <li><span class="step-number">2.</span> Scorri e seleziona <strong>"Aggiungi a Home"</strong> <span class="ios-plus-icon">‚ûï</span></li>
            <li><span class="step-number">3.</span> Tocca <strong>"Aggiungi"</strong> in alto a destra ‚úÖ</li>
          </ol>
          <div class="ios-hint-note">üí° L'app apparir√† sulla tua schermata Home come un'app nativa</div>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <p>¬© <span id="footer-year"></span> Michele Carnimeo. Tutti i diritti riservati.<br>TPL FVG √® un marchio di TPL FVG S.C. a R.L. ¬∑ <a href="test.html" style="color: inherit; text-decoration: none; transition: text-decoration 0.3s ease;" onmouseover="this.style.textDecoration='underline'" onmouseout="this.style.textDecoration='none'">TPL Autisti 1.3.3</a></p>
    <div class="footer-links">
      <a href="https://t.me/+eoJ9nYFFrjphMzVk" target="_blank" class="telegram-link" title="Canale Telegram">
        <span class="telegram-icon">üì¢</span> Avvisi & Aggiornamenti
      </a>
      <a href="https://t.me/+2yIF2NfPYt82MWI0" target="_blank" class="telegram-link" title="Gruppo Telegram">
        <span class="telegram-icon">üêõ</span> Segnala Errori
      </a>
    </div>
  </footer>

  <!-- Pulsante torna su -->
  <button class="scroll-to-top" onclick="scrollToTop()" title="Torna su">
    ‚Üë
  </button>

  <!-- Modal selezione linee -->
  <div id="linee-fermate-modal" class="fermate-modal">
    <div class="fermate-modal-content">
      <div class="fermate-modal-header">
        <h3 id="linee-fermate-modal-title">Seleziona linea</h3>
        <div class="fermate-modal-actions">
          <button id="linee-fermate-modal-close" class="fermate-modal-close" aria-label="Chiudi">√ó</button>
        </div>
      </div>
      <div class="fermate-modal-body">
        <!-- Lista linee -->
        <div class="fermate-list-container">
          <ul id="linee-fermate-modal-list" class="fermate-modal-list">
            <!-- Linee generate dinamicamente -->
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal conferma riavvio app -->
  <div id="cache-modal" class="cache-modal">
    <div class="cache-modal-content">
      <div class="cache-modal-header">
        <h3 id="modal-title">üîÑ Verifica Aggiornamenti</h3>
      </div>
      <div class="cache-modal-body">
        <p id="modal-message">Verifico se ci sono aggiornamenti disponibili...</p>
        <p class="cache-modal-warning" id="modal-warning" style="display: none;">‚ö†Ô∏è L'app si ricaricher√† automaticamente e tornerai alla pagina di benvenuto.</p>
      </div>
      <div class="cache-modal-footer">
        <button id="cache-cancel" class="cache-modal-btn cache-modal-cancel">Annulla</button>
        <button id="cache-confirm" class="cache-modal-btn cache-modal-confirm" style="display: none;">Riavvia e Aggiorna (v1.2)</button>
      </div>
    </div>
  </div>

  <!-- Script principale -->
  <script src="script.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('sw.js').catch(err => console.error('SW registration failed', err));
      });
    }
  </script>
</body>

</html>